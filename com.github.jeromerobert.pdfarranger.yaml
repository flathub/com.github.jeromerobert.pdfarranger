---
id: com.github.jeromerobert.pdfarranger
runtime: org.gnome.Platform
runtime-version: '3.36'
sdk: org.gnome.Sdk
command: pdfarranger

finish-args:
  - --socket=wayland
  - --socket=x11
  - --share=ipc
  - --filesystem=home

modules:
  - shared-modules/intltool/intltool-0.51.json
  - shared-modules/openjpeg/openjpeg.json # dependency of poppler

  - name: poppler
    buildsystem: cmake-ninja
    config-opts:
      - -DENABLE_UTILS=OFF
      - -DENABLE_CPP=OFF
      - -DENABLE_QT5=OFF
    sources:
      - url: https://poppler.freedesktop.org/poppler-0.88.0.tar.xz
        sha256: b4453804e9a5a519e6ceee0ac8f5efc229e3b0bf70419263c239124474d256c7
        type: archive

  - name: python-distutils-extra
    buildsystem: simple
    build-commands:
      - pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} .
    sources:
      - url: https://launchpad.net/python-distutils-extra/trunk/2.39/+download/python-distutils-extra-2.39.tar.gz
        sha256: 723f24f4d65fc8d99b33a002fbbb3771d4cc9d664c97085bf37f3997ae8063af
        type: archive

  - name: pikepdf
    buildsystem: simple
    build-commands:
      - pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} lxml-*.whl pikepdf-*.whl
    sources:
      - url: https://files.pythonhosted.org/packages/d4/26/b6e65898fee3bcb49ed98a738ab9100060f92fd9a6c61b2313c22f13e08b/pikepdf-1.15.1-cp37-cp37m-manylinux2010_x86_64.whl
        sha256: 61daf7abdbb210ec91af326e4c56322ce0dfba30cd29e12bc77eda54830ac0cc
        type: file
      - url: https://files.pythonhosted.org/packages/ba/39/0b5d76e64681243db516491bc449eff847d2708b465b60465b31ca13522e/lxml-4.5.1-cp37-cp37m-manylinux1_x86_64.whl
        sha256: afb53edf1046599991fb4a7d03e601ab5f5422a5435c47ee6ba91ec3b61416a6
        type: file

  - name: pdfarranger
    buildsystem: simple
    build-commands:
      - pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} .
    sources:
      - url: https://github.com/jeromerobert/pdfarranger
        tag: 1.5.3
        commit: 5cfcf50d66f6f132a849ab4e826798e833e61225
        type: git

cleanup:
  - /include
  - /lib/pkgconfig
  - /app/lib/openjpeg-2.3
  - /app/bin/opj_*
